---
title: "HDT 1"
output: html_document
date: "2023-02-02"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
peliculas <- read.csv("C:\\Users\\javie\\Desktop\\U\\2023f\\mineria\\movies.csv")
```
Descripcion del conjunto de datos.
El conjunto esta de datos esta compuesto por `rnrow(peliculas)` filas y `rncol(peliculas)` columnas

### 1. Resumen del conjunto de datos

```{r}
head(peliculas)
summary(peliculas)
```
#2. Descripcion de las variables
#Aquí se describen las variables:

```{r}


class(peliculas$id)
```
#cualitativa ordinal
```{r}
class(peliculas$budget)
```
#cuantitativa continua
```{r}
class(peliculas$genres)
```
#cualitativa nominal
```{r}
class(peliculas$homePage)
```
#cualitativa nominal
```{r}
class(peliculas$productionCompany)
```
#cualitativa nominal
```{r}
class(peliculas$productionCompanyCountry)
```
#cualitativa nominal
```{r}
class(peliculas$productionCountry)
```
#cualitativa nominal
```{r}
class(peliculas$revenue)
```
#cuantitativa continua
```{r}
class(peliculas$runtime)
```
#cuantitativa discreta
```{r}
class(peliculas$video)
```
#cualitativa ordinal
```{r}
class(peliculas$director)
```
#cualitativa nominal
```{r}
class(peliculas$actors)
```
#cualitativa nominal
```{r}
class(peliculas$actorsPopularity)
```
#cuantitativa continua
```{r}
class(peliculas$actorsCharacter)
```
#cualitativa ordinal
```{r}
class(peliculas$originalTitle)
```
#cualitativa ordinal
```{r}
class(peliculas$title)
```
#cualitativa ordinal
```{r}
class((peliculas$originalLanguage))
```
#cualitativa ordinal
```{r}
class(peliculas$popularity)
```
#cuantitativa continua
```{r}
class(peliculas$releaseDate)
```
#cualitativa ordinal
```{r}
class(peliculas$voteAvg)
```
#cuantitativa continua
```{r}
class(peliculas$voteCount)
```
#cuantitativa discreta
```{r}
class(peliculas$genresAmount)
```
#cuantitativa discreta
```{r}
class(peliculas$productionCoAmount)
```
#cuantitativa discreta
```{r}
class(peliculas$productionCountriesAmount)
```
#cuantitativa discreta
```{r}
class(peliculas$actorsAmount)
```
#cuantitativa discreta
```{r}
class(peliculas$castWomenAmount)
```
#cuantitativa discreta
```{r}
class(peliculas$castMenAmount)
```
#cuantitativa discreta
```{r}

```
### 4.1) Top 10 de peliculas con más presupuesto. 

```{r}
sortedByBudget <- peliculas[order(-peliculas$budget),]
top10 <- head(sortedByBudget, 10)
top10
```
#4.2: Top 10 peliculas con más ingresos
```{r}
sortedByGross <- peliculas[order(-peliculas$revenue),]
top10grossing<- head(sortedByGross, 10)
top10grossing

```
#4.3: pelicula con mas votos
```{r}
sorted <- peliculas[order(-peliculas$voteCount),]
top10votos <- head(sorted, 10)
top10votos
```
#4.4: Top 10 peliculas con menos votos

```{r}
sorted10menos <- tail(sorted, 10)
sorted10menos

```
#4.5: ¿Cuántas  películas  se  hicieron  en  cada  año?  ¿En  qué  año  se  hicieron  más películas? Haga un gráfico de barras 
```{r}
peliculas$releaseDate = as.Date(peliculas$releaseDate, "%Y-%m-%d")
peliculas$year = format(peliculas$releaseDate, "%Y")
peliculasPoraño = table(peliculas$year)
peliculasPoraño
barplot(peliculasPoraño, xlab = "Año", ylab = "Numero de peliculas")
```

#4.6: ¿Cuál es el género principal de las 20 películas más recientes? ¿Cuál es el género principal que predomina en el conjunto de datos? Represéntelo usando un gráfico 

```{r}
peliculasOrd <- peliculas[order(peliculas$releaseDate),]
peliculasRec <- peliculasOrd[1:20, ]

# Split the genre column into separate rows for each movie
peliculasRec <- do.call(rbind, strsplit(as.character(peliculasRec$genres), ", "))

# Find the most frequent genre among the 20 most recent movies
peliculasFreq = names(sort(table(peliculasRec), increasing=TRUE))[1]

# Plot a bar graph showing the distribution of genres in the 20 most recent movies
barplot(table(peliculasRec), xlab="Generos", ylab="Cuenta", main=paste("Distribucion de los generos en las 20 peliculas más recientes\n Genero predominante: ", peliculasFreq))



```

#4.7: ¿Las películas de qué genero principal obtuvieron mayores ganancias? 

``` {r}
top_5_g <- sortedByGross[1:5, ]
cat("El top de peliculas por generos es:", "\n")
for (i in 1:5) {
  cat(top_5_g$title[i], ":", top_5_g$genres[i], "\n")
}

```

#4.10: ¿Quiénes son los directores que hicieron las 20 películas mejor calificadas? 

```{r}
peliculas_na <- peliculas[!is.na(peliculas$voteCount), ]


peliculas_ord <- peliculas[order(-peliculas$voteCount), ]

# select the top 20 movies along with their directors
top_20_movies <- peliculas_ord[1:20, c("title", "director")]

# print the result
print(top_20_movies)

```


